##
 # givekit.mcfunction
 # Super Sad Bros Melee
 #
 # Created by Sw3d15h_F1s4
##

#returns sephiroth's kit when his abilities are up
replaceitem entity @s[scores={abilityTimer=..0},nbt=!{Inventory:[{tag:{Tags:["stigma"]}}]}] hotbar.1 carrot_on_a_stick{display:{Name:'[{"text":"S","color":"dark_gray"},{"text":"t","color":"#583232"},{"text":"i","color":"#712525"},{"text":"g","color":"#8B1919"},{"text":"m","color":"#A40C0C"},{"text":"a","color":"dark_red"}]',Lore:['{"text":"Sephiroth uses his green","color":"#67CF00","italic":false}','{"text":"materia to erode all biological","color":"#67CF00","italic":false}','{"text":"life within a 9 block radius ","color":"#67CF00","italic":false}','{"text":"for 3 seconds.","color":"#67CF00","italic":false}']},CustomModelData:13020,Tags:["stigma","ability"]}
replaceitem entity @s[scores={ability2Timer=..0},nbt=!{Inventory:[{tag:{Tags:["black_materia"]}}]}] hotbar.2 carrot_on_a_stick{display:{Name:'[{"text":"B","color":"dark_gray"},{"text":"l","color":"#4A3939"},{"text":"a","color":"#563333"},{"text":"c","color":"#612D2D"},{"text":"k ","color":"#6D2828"},{"text":"M","color":"#782222"},{"text":"a","color":"#841C1C"},{"text":"t","color":"#8F1616"},{"text":"e","color":"#9B1111"},{"text":"r","color":"#A60B0B"},{"text":"i","color":"#B20505"},{"text":"a","color":"dark_red"}]',Lore:['{"text":"The strongest materia of them","color":"#8B00C7","italic":false}','{"text":"all, it summons meteors from","color":"#8B00C7","italic":false}','{"text":"the sky to destroy all in","color":"#8B00C7","italic":false}','{"text":"Sephiroth\'s path.","color":"#8B00C7","italic":false}']},CustomModelData:13010,Tags:["black_materia","ability"]}
replaceitem entity @s[scores={ability3Timer=..0},nbt=!{Inventory:[{tag:{Tags:["restora"]}}]}] hotbar.3 carrot_on_a_stick{display:{Name:'[{"text":"R","color":"dark_gray"},{"text":"e","color":"#463B3B"},{"text":"s","color":"#4D3737"},{"text":"t","color":"#553333"},{"text":"o","color":"#5C3030"},{"text":"r","color":"#642C2C"},{"text":"e ","color":"#6B2828"},{"text":"B","color":"#732525"},{"text":"a","color":"#7A2121"},{"text":"s","color":"#821D1D"},{"text":"e ","color":"#891919"},{"text":"M","color":"#911616"},{"text":"a","color":"#981212"},{"text":"t","color":"#A00E0E"},{"text":"e","color":"#A70B0B"},{"text":"r","color":"#AF0707"},{"text":"i","color":"#B60303"},{"text":"a","color":"dark_red"}]',Lore:['{"text":"This materia both","color":"#FFEE00","italic":false}','{"text":"heals Sephiroth\'s health and","color":"#FFEE00","italic":false}','{"text":"expand his amount of health","color":"#FFEE00","italic":false}','{"text":"to full for 5 seconds!","color":"#FFEE00","italic":false}']},CustomModelData:13030,Tags:["restora","ability"]}
replaceitem entity @s[scores={helperTimer2=..0},nbt=!{Inventory:[{tag:{Tags:["gravity_manip"]}}]}] hotbar.4 carrot_on_a_stick{display:{Name:'[{"text":"G","color":"dark_gray"},{"text":"r","color":"#463B3B"},{"text":"a","color":"#4D3838"},{"text":"v","color":"#543434"},{"text":"i","color":"#5B3131"},{"text":"t","color":"#622D2D"},{"text":"y ","color":"#692A2A"},{"text":"M","color":"#702626"},{"text":"a","color":"#772323"},{"text":"n","color":"#7E1F1F"},{"text":"i","color":"#851C1C"},{"text":"p","color":"#8C1818"},{"text":"u","color":"#931515"},{"text":"l","color":"#9A1111"},{"text":"a","color":"#A10E0E"},{"text":"t","color":"#A80A0A"},{"text":"i","color":"#AF0707"},{"text":"o","color":"#B60303"},{"text":"n","color":"dark_red"}]',Lore:['{"text":"When activated, Sephiroth","color":"gray","italic":false}','{"text":"quickly ascends to gain height,","color":"gray","italic":false}','{"text":"and then is able to swoop down with","color":"gray","italic":false}','{"text":"his gliding capabilities!","color":"gray","italic":false}','{"text":"When falling, press SPACE to glide","color":"#DBDBDB","italic":false}','{"text":"and move the mouse to control flight!","color":"#DBDBDB","italic":false}']},CustomModelData:13040,Tags:["gravity_manip","ability"]}

replaceitem entity @s[scores={ultTimer=..0},nbt=!{Inventory:[{tag:{Tags:["one_wing"]}}]}] hotbar.8 carrot_on_a_stick{display:{Name:'[{"text":"O","color":"dark_gray","bold":true,"underlined":true},{"text":"n","color":"#483A3A","bold":true,"underlined":true},{"text":"e ","color":"#523535","bold":true,"underlined":true},{"text":"W","color":"#5C3030","bold":true,"underlined":true},{"text":"i","color":"#662B2B","bold":true,"underlined":true},{"text":"n","color":"#6F2626","bold":true,"underlined":true},{"text":"g","color":"#792121","bold":true,"underlined":true},{"text":"e","color":"#831D1D","bold":true,"underlined":true},{"text":"d ","color":"#8D1818","bold":true,"underlined":true},{"text":"A","color":"#961313","bold":true,"underlined":true},{"text":"n","color":"#A00E0E","bold":true,"underlined":true},{"text":"g","color":"#AA0909","bold":true,"underlined":true},{"text":"e","color":"#B40404","bold":true,"underlined":true},{"text":"l","color":"dark_red","bold":true,"underlined":true}]'},CustomModelData:1300020,Tags:["one_wing"]}

replaceitem entity @s[nbt=!{Inventory:[{id:"minecraft:netherite_sword"}]}] hotbar.0 netherite_sword{display:{Name:'[{"text":"M","color":"dark_gray","bold":true,"italic":false},{"text":"a","color":"#513636","bold":true,"italic":false},{"text":"s","color":"#632D2D","bold":true,"italic":false},{"text":"a","color":"#752424","bold":true,"italic":false},{"text":"m","color":"#871B1B","bold":true,"italic":false},{"text":"u","color":"#991212","bold":true,"italic":false},{"text":"n","color":"#AB0909","bold":true,"italic":false},{"text":"e","color":"dark_red","bold":true,"italic":false}]'},HideFlags:7,Unbreakable:1b,CustomModelData:13001,Enchantments:[{id:"minecraft:thorns",lvl:3s},{id:"minecraft:smite",lvl:3s},{id:"minecraft:sweeping",lvl:3s}]}
replaceitem entity @s[nbt=!{Inventory:[{id:"minecraft:elytra"}]}] armor.chest elytra{CustomModelData:1300030,Unbreakable:1b}
replaceitem entity @s[nbt=!{Inventory:[{id:"minecraft:cooked_beef"}]}] hotbar.5 cooked_beef 64

execute unless score mapType gameState matches 4 run replaceitem entity @s[nbt=!{Inventory:[{id:"minecraft:oak_button"}]}] armor.head oak_button{HideFlags:57,Unbreakable:1b,AttributeModifiers:[{AttributeName:"generic.armor",Name:"generic.armor",Amount:8,Operation:0,Slot:"head",UUID:[I;1001,203,4324,534]},{AttributeName:"generic.max_health",Name:"generic.max_health",Amount:-6,Operation:0,Slot:"head",UUID:[I;12324,34234,6565,234234]}],Enchantments:[{id:"minecraft:feather_falling",lvl:255},{id:"blast_protection",lvl:3}]}
execute if score mapType gameState matches 4 run replaceitem entity @s[nbt=!{Inventory:[{id:"minecraft:oak_button"}]}] armor.head oak_button{HideFlags:57,Enchantments:[{id:"minecraft:feather_falling",lvl:255s},{id:"minecraft:blast_protection",lvl:3s},{id:"minecraft:depth_strider",lvl:4s}],AttributeModifiers:[{AttributeName:"generic.armor",Name:"generic.armor",Amount:8,Operation:0,UUID:[I;1001,203,4324,534],Slot:"head"},{AttributeName:"generic.max_health",Name:"generic.max_health",Amount:-6,Operation:0,UUID:[I;12324,34234,6565,234234],Slot:"head"}]}

#sephiroth specific shit

execute as @e[type=arrow,tag=SephiArrow] at @s run function melee:season_2/sephiroth/materia_loop
kill @e[type=area_effect_cloud,nbt={Effects:[{Id:14b}]}]


#sephiroth ability targeting display
execute at @s[nbt={SelectedItem:{tag:{Tags:["stigma"]}}}] as @e[distance=0.1..9] at @s run particle witch ~ ~ ~ 0.1 0.1 0.1 1 2 force @a[nbt={SelectedItem:{tag:{Tags:["stigma"]}}}]

execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~-6 ~ ~ run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~6 ~ ~ run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~4.24 ~ ~-4.24 run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~ ~ ~6 run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~ ~ ~-6 run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~-4.24 ~ ~-4.24 run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~-4.24 ~ ~4.24 run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]
execute at @s[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}] at @s positioned ~4.24 ~ ~4.24 run particle flame ~ ~ ~ 0.6 0.6 0.6 0 2 force @a[nbt={SelectedItem:{tag:{Tags:["black_materia"]}}}]